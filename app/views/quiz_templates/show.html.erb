<nav aria-label="breadcrumb">
  <ul>
    <li>
      <a href="/">
        <%= current_user.username %>'s quizzes
      </a>
    </li>
    <li>
      <%= @the_quiz.topic %>
    </li>
  </ul>
</nav>

<article>
  <div>
    <a href="/delete_quiz/<%= @the_quiz.id %>">
      Delete quiz
    </a>
  </div>
  <dl>
    <dt>
      Topic
    </dt>
    <dd>
      <%= @the_quiz.topic %>
    </dd>

    <dt>
      Score
    </dt>
    <dd>
      <% if @the_quiz.score.present? %>
        <%= @the_quiz.score %>
      <% else %>
        Not yet complete
      <% end %>
    </dd>

    <dt>
      Created at
    </dt>
    <dd>
      <%= time_ago_in_words(@the_quiz.created_at) %> ago
    </dd>
  </dl>
</article>

<article>
  <ul>
    <% existing_messages = @the_quiz.messages.order(:created_at) %>

    <% existing_messages.each do |a_message| %>
      <li>
        <dl>
          <dt>
            <% if a_message.role == "system" %>
              ðŸŽ© system
            <% elsif a_message.role == "assistant" %>
              ðŸ¤– assistant
            <% elsif a_message.role == "user" %>
              ðŸ‘¤ <%= current_user.username %>
            <% end %>
          </dt>
          <dd>
            <%= simple_format(a_message.content) %>
          </dd>
        </dl>
      </li>
    <% end %>

    <li>
      <form action="/insert_message" method="post">

        <input type="hidden" id="quiz_id_box" name="query_quiz_id" value="<%= @the_quiz.id %>">

        <div>
          <label for="content_box" class="visually-hidden">
            Content
          </label>

          <textarea id="content_box" name="query_content"></textarea>
        </div>

        <button type="submit">
          Respond
        </button>
      </form>
    </li>
  </ul>
</article>
